<!doctype html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OpenSSL Studio</title>
    <link href="web/bootstrap.min.css" rel="stylesheet" type="text/css">
    <script src="web/bootstrap.min.js"></script>
    <script src="web/FileSaver.js"></script>
    <script src="web/common.js"></script>
    <script src="web/diags.js"></script>
    <script src="web/keygen.js"></script>
    <script src="web/onload.js"></script>
</head>

<body class="p-3 m-0 border-0 bd-example m-0 border-0">
    <!-- The content-->
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" aria-current="page" data-bs-toggle="tab" data-bs-target="#diag"
                type="button" role="tab" aria-controls="diag" aria-selected="true">Diagnostics</a>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#key-gen" type="button" role="tab"
                aria-controls="key-gen" aria-selected="false">Key generator</a>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#x509-Validate" type="button" role="tab"
                aria-controls="x509-Validate" aria-selected="false">x509 Validate</a>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#x509-self-signed" type="button" role="tab"
                aria-controls="x509-self-signed" aria-selected="false">x509 self-signed cert</a>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#x509-CA-signed" type="button" role="tab"
                aria-controls="x509-CA-signed" aria-selected="false">x509 CA signed cert</a>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#x509-CRL" type="button" role="tab"
                aria-controls="x509-CRL" aria-selected="false">x509 CRL</a>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tls" type="button" role="tab"
                aria-controls="tls" aria-selected="false">Tls</a>
        </li>
    </ul>

    <div class="tab-content" id="myTabContent">

        <!-- TAB Diagnostics-->
        <div class="tab-pane fade show active" id="diag" role="tabpanel" aria-labelledby="diag-tab">
            <div class="container-fluid">
                <div class="row">
                    <h2>OpenSSL diagnostics</h2>
                    <button onclick="fetchDiagData()" type="submit" class="btn btn-primary">
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"
                            id="btn-diag-reload"></span>
                        <span class="sr-only">Re-generate</span>
                    </button>
                </div>
                <div class="row gx-4">
                    <div class="col-sm-5">
                        <div class="row py-2">
                            <span class="border py-2">
                                <h4>OpenSSL version</h4>
                                <pre><small><code id="diag_version_code"></code></small></pre>
                                <div id="diag_version"></div>
                            </span>
                        </div>
                        <div class="row py-2">
                            <span class="border py-2">
                                <h4>Trusted certificates path</h4>
                                <pre><small><code id="diag_trust_cert_path_code"></code></small></pre>
                                <div id="diag_trust_cert_path"></div>
                            </span>
                        </div>
                        <div class="row py-2">
                            <span class="border py-2">
                                <h4>Trusted certificates path content</h4>
                                <pre><small><code>ls -l</code></small></pre>
                                <div id="diag_trust_cert_path_cont"></div>
                            </span>
                        </div>
                    </div>
                    <div class="col-sm-7">
                        <h4>OpenSSL supported ciphers</h4>
                        <pre><small><code id="diag_ciphers_code"></code></small></pre>
                        <div id="diag_ciphers"></div>
                        <table class="table" id="diag_ciphers_table">
                            <thead>
                                <tr>
                                    <th scope="col">Cipher</th>
                                    <th scope="col">TLS version</th>
                                    <th scope="col">Kx</th>
                                    <th scope="col">Au</th>
                                    <th scope="col">Enc</th>
                                    <th scope="col">Mac</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!--<tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>Otto</td>
                                <td>@mdo</td>
                                <td>@mdo</td>
                                <td>@mdo</td>
                            </tr>-->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB Key Gen-->
        <div class="tab-pane fade" id="key-gen" role="tabpanel" aria-labelledby="key-gen">
            <div class="container-fluid">
                <div class="row">
                    <h2>Key generator</h2>
                </div>
                <div class="row py-2">
                    <span class="border py-2">
                        <span>Key cipher</span>
                        <hr>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="keyType" id="keyTypeRSA"
                                onchange="keyGenTypeOnChange()" checked>
                            <label class="form-check-label" for="keyTypeRSA">
                                RSA
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="keyType" id="keyTypeEC"
                                onchange="keyGenTypeOnChange()">
                            <label class="form-check-label" for="keyTypeEC">
                                Elliptic curves
                            </label>
                        </div>
                    </span>
                </div>
                <div class="row py-2">
                    <div class="border py-2" id="keyGenRSAOpts">
                        <span>Key size</span>
                        <hr>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="rsaSize" id="rsaKeySize2048"
                                onchange="rsaKeySizeOnChange()">
                            <label class="form-check-label" for="rsaKeySize2048">
                                2048
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="rsaSize" id="rsaKeySize4096"
                                onchange="rsaKeySizeOnChange()" checked>
                            <label class="form-check-label" for="rsaKeySize4096">
                                4096
                            </label>
                        </div>
                    </div>
                    <div class="border py-2" id="keyGenECOpts" style="display: none">
                        <span>Curve name</span>
                        <hr>
                        <select class="form-select" id="inlineFormSelectPref">
                            <option selected>Choose...</option>
                            <option value="1">One</option>
                            <option value="2">Two</option>
                            <option value="3">Three</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 border p-2">
                        <span>Private key in PEM format</span>
                        <hr>
                        <pre><small><code id="gen_key_code"></code></small></pre>
                        <div class="row p-4">
                            <textarea class="form-control bg-secondary" rows="15" placeholder="Key in PEM format"
                                id="keygen_result" readonly></textarea>
                        </div>
                        <div class="row p-4">
                            <div class="col-sm-4 d-grid gap-2 d-md-block">
                                <button onclick="genKey()" type="submit" class="btn btn-primary"><span
                                        class="spinner-border spinner-border-sm" role="status" aria-hidden="true"
                                        id="btn-genkey"></span>
                                    <span class="sr-only">Generate</span>
                                </button>
                            </div>
                            <div class="col-sm-4 d-grid gap-2 d-md-block">
                                <button onclick="downloadPrivateKey()" type="submit"
                                    class="btn btn-primary">Download</button>
                            </div>
                        </div>
                        <div class="row">
                            <div id="cert_validation_result"></div>
                        </div>
                    </div>
                    <div class="col-sm-6 border p-2">
                        <span>Public key in PEM format</span>
                        <hr>
                        <pre><small><code id="gen_pubkey_code">openssl</code></small></pre>
                        <div class="row p-4">
                            <textarea class="form-control bg-secondary" rows="15" placeholder="Key in PEM format"
                                id="pubkeygen_result" readonly></textarea>
                        </div>
                        <div class="row p-4">
                            <div class="col-sm-4 d-grid gap-2 d-md-block">
                                <button onclick="downloadPublicKey()" type="submit"
                                    class="btn btn-primary">Download</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <!-- TAB x509 Validate-->
        <div class="tab-pane fade" id="x509-Validate" role="tabpanel" aria-labelledby="x509-tab">
            <div class="container-fluid">
                <div class="row">
                    <h2>x509 Validate</h2>
                </div>
                <div class="row">
                    <div class="col-sm-5">
                        <div class="row py-2">
                            <textarea class="span6" rows="3" placeholder="Copy paste certificate here"
                                required></textarea>
                        </div>
                        <div class="row py-2">
                            <div class="d-grid gap-2 d-md-block">
                                <button onclick="validatex509Cert()" type="submit"
                                    class="btn btn-primary">Validate</button>
                            </div>
                        </div>
                        <div class="row">
                            <div id="cert_validation_result"></div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB x509 Self-signed-->
        <div class="tab-pane fade" id="x509-self-signed" role="tabpanel" aria-labelledby="x509-tab">
            <div class="container-fluid">
                <div class="row">
                    <h2>Generate x509 self-signed certificate</h2>
                </div>
                <div class="row">
                    <div class="col-sm-5">
                        <div class="row py-2">
                            <textarea class="span6" rows="3" placeholder="Copy paste certificate here"
                                required></textarea>
                        </div>
                        <div class="row py-2">
                            <div class="d-grid gap-2 d-md-block">
                                <button onclick="validatex509Cert()" type="submit"
                                    class="btn btn-primary">Validate</button>
                            </div>
                        </div>
                        <div class="row">
                            <div id="cert_validation_result"></div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB CA Signed-->
        <div class="tab-pane fade" id="x509-CA-signed" role="tabpanel" aria-labelledby="x509-tab">
            <div class="container-fluid">
                <div class="row">
                    <h2>Generate x509 CA-signed certificate</h2>
                </div>
                <div class="row">
                    <div class="col-sm-5">
                        <div class="row py-2">
                            <textarea class="span6" rows="3" placeholder="Copy paste certificate here"
                                required></textarea>
                        </div>
                        <div class="row py-2">
                            <div class="d-grid gap-2 d-md-block">
                                <button onclick="validatex509Cert()" type="submit"
                                    class="btn btn-primary">Validate</button>
                            </div>
                        </div>
                        <div class="row">
                            <div id="cert_validation_result"></div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB x509 CRL -->
        <div class="tab-pane fade" id="x509-CRL" role="tabpanel" aria-labelledby="x509-tab">
            <div class="container-fluid">
                <div class="row">
                    <h2>Generate x509 CRL</h2>
                </div>
                <div class="row">
                    <div class="col-sm-5">
                        <div class="row py-2">
                            <textarea class="span6" rows="3" placeholder="Copy paste certificate here"
                                required></textarea>
                        </div>
                        <div class="row py-2">
                            <div class="d-grid gap-2 d-md-block">
                                <button onclick="validatex509Cert()" type="submit"
                                    class="btn btn-primary">Validate</button>
                            </div>
                        </div>
                        <div class="row">
                            <div id="cert_validation_result"></div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB TLS -->
        <div class="tab-pane fade" id="tls" role="tabpanel" aria-labelledby="tls-tab">
            <div class="container-fluid">
                <div class="row">
                    <h2>TLS Stuff</h2>
                </div>
                <div class="row">
                    <div class="col-sm-5">
                        <div class="row py-2">
                            <textarea class="span6" rows="3" placeholder="Copy paste certificate here"
                                required></textarea>
                        </div>
                        <div class="row py-2">
                            <div class="d-grid gap-2 d-md-block">
                                <button onclick="validatex509Cert()" type="submit"
                                    class="btn btn-primary">Validate</button>
                            </div>
                        </div>
                        <div class="row">
                            <div id="cert_validation_result"></div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
